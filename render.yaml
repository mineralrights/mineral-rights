# Render Blueprint Configuration
# =============================
# 
# This file defines both your web service and job service
# for the mineral rights processing application.

services:
  # Web Service for quick processing and job management
  - type: web
    name: mineral-rights-api
    env: python
    plan: starter
    buildCommand: |
      pip install -r requirements.txt
    startCommand: uvicorn api.app:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: ANTHROPIC_API_KEY
        sync: false
      - key: PYTHON_VERSION
        value: 3.11
    healthCheckPath: /health

  # Job Service for long-running processing (8+ hours)
  - type: job
    name: mineral-rights-processor
    env: python
    plan: starter
    buildCommand: |
      pip install -r requirements.txt
    startCommand: python render_jobs_solution.py "$INPUT_PDF_PATH" --mode "$PROCESSING_MODE" --strategy "$SPLITTING_STRATEGY"
    envVars:
      - key: ANTHROPIC_API_KEY
        sync: false
      - key: INPUT_PDF_PATH
        value: "/tmp/sample.pdf"  # Default path - will be overridden per job
      - key: PROCESSING_MODE
        value: "multi_deed"
      - key: SPLITTING_STRATEGY
        value: "smart_detection"
      - key: PYTHON_VERSION
        value: 3.11
